<div class="dropdown is-right" data-controller="dropdown">
  <div class="dropdown-trigger">
    <button class="button" data-action="click->dropdown#toggle">
      <span>Actions</span>
      <span class="icon is-small">
        <i class="fas fa-angle-down"></i>
      </span>
    </button>
  </div>
  <div class="dropdown-menu">
    <div class="dropdown-content">
      <%= link_to icon('Edit', 'fas fa-edit'), edit_admin_entry_path(entry), class: 'dropdown-item' %>
      <% if entry.is_photo? && entry.is_published? %>
        <%= link_to icon('Share', 'fas fa-share-square'), share_admin_entry_path(entry), class: 'dropdown-item', 'data-controller': 'modal', 'data-action': 'click->modal#open' %>
      <% end %>
      <% if entry.is_photo? %>
        <%= link_to icon('Crops', 'fas fa-crop'), crops_admin_entry_path(entry), class: 'dropdown-item', 'data-controller': 'modal', 'data-action': 'click->modal#open' %>
      <% end %>
      <hr class="dropdown-divider">
      <% if entry.is_queued? && action_name == 'queued' %>
        <% if entry != Entry.queued.first %>
          <%= link_to icon('Move to top', 'fas fa-angle-double-up'), top_admin_entry_path(entry.id), method: :post, data: { queue: 'top' }, class: 'dropdown-item' %>
          <%= link_to icon('Move up', 'fas fa-angle-up'), up_admin_entry_path(entry.id), method: :post, data: { queue: 'up' }, class: 'dropdown-item' %>
        <% end %>
        <% if entry != Entry.queued.last %>
          <%= link_to icon('Move down', 'fas fa-angle-down'), down_admin_entry_path(entry.id), method: :post, data: { queue: 'down' }, class: 'dropdown-item' %>
          <%= link_to icon('Move to bottom', 'fas fa-angle-double-down'), bottom_admin_entry_path(entry.id), method: :post, data: { queue: 'bottom' }, class: 'dropdown-item' %>
        <% end %>
        <hr class="dropdown-divider">
      <% end %>
      <%= link_to icon('Clear cache', 'fas fa-eraser'), invalidate_admin_entry_path(entry.id), remote: true, method: :post, data: { confirm: "Entries are currently cached for #{distance_of_time_in_words(Time.now, Time.now + @max_age.minutes)}. This will clear this entry from the cache and make any changes publicly visible right away. Do you want to proceed?" }, class: 'dropdown-item' %>
      <%= link_to icon('Refresh metadata', 'fas fa-sync'), refresh_metadata_admin_entry_path(entry.id), remote: true, method: :post, data: { confirm: 'This will refresh the entry’s location, annotation, and palette metadata and update its tags. Are you sure you want to proceed?' }, class: 'dropdown-item' %>
      <hr class="dropdown-divider">
      <% if entry.is_queued? %>
        <%= link_to icon('Send to drafts', 'fas fa-pencil-alt'), draft_admin_entry_path(entry), method: :patch, data: { confirm: 'Are you sure you want to send this entry to the drafts? It will lose its place in the queue.' }, class: 'dropdown-item' %>
      <% elsif entry.is_draft? %>
        <%= link_to icon('Send to queue', 'fas fa-clock'), queue_admin_entry_path(entry), method: :patch, data: { confirm: 'Are you sure you want to send this entry to the queue?' }, class: 'dropdown-item' %>
      <% end %>
      <% if !entry.is_published? %>
        <%= link_to icon('Publish it!', 'fas fa-rocket'), publish_admin_entry_path(entry), method: :patch, data: { confirm: 'Are you sure you want to publish this entry? This can’t be undone!' }, class: 'dropdown-item has-text-danger' %>
        <hr class="dropdown-divider">
      <% end %>
      <%= link_to icon('Delete', 'fas fa-trash-alt'), admin_entry_path(entry.id), method: :delete, data: { confirm: 'Are you absolutely sure you want to delete it forever? It really can’t be undone!' }, class: 'dropdown-item has-text-danger' %>
    </div>
  </div>
</div>
